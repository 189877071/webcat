<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>头像采集</title>
</head>

<body>
    <div class="box">
        <h1>数据</h1>
        <img src="" alt="" id="oimg">
    </div>
    <ul class="name_show"><li>富察忆梅</li><li>干月天</li><li>让姝艳</li><li>全问香</li><li>奇宜春</li><li>拜景山</li><li>昝凝丹</li><li>似阳飇</li><li>阳夏月</li><li>尹清懿</li><li>伏愉婉</li><li>朋玲琳</li><li>拓跋元白</li><li>丁欣荣</li><li>田依然</li><li>欧睿好</li><li>堵幼荷</li><li>戚婷秀</li><li>殷莎莎</li><li>闵平婉</li><li>洋瑛琭</li><li>生康安</li><li>仇听安</li><li>喜和悌</li><li>年修诚</li><li>钞锐利</li><li>皮高旻</li><li>委山彤</li><li>井冰蝶</li><li>宓忆彤</li><li>幸骞魁</li><li>羊若薇</li><li>焉浩阔</li><li>运芮波</li><li>宝飞鹏</li><li>同寻云</li><li>枝雨竹</li><li>烟阳辉</li><li>赖诗兰</li><li>汉芷珍</li><li>波香薇</li><li>军丽玉</li><li>厍元冬</li><li>羊舌欣美</li><li>连梦菡</li><li>丛雅隽</li><li>潘听南</li><li>官天薇</li><li>完忆枫</li><li>鲜新霁</li><li>狄含娇</li><li>青靖琪</li><li>抗琛丽</li><li>泣安然</li><li>聊夏蓉</li><li>谷梁逸致</li><li>东尔阳</li><li>伦飞烟</li><li>稽睿哲</li><li>尔思菱</li><li>达雅丽</li><li>示芮澜</li><li>翠骊洁</li><li>蔚云飞</li><li>咎阳阳</li><li>班怀芹</li><li>银夏菡</li><li>保问凝</li><li>仝书桃</li><li>莱春柔</li><li>巴淑华</li><li>理音景</li><li>由致萱</li><li>代诗蕊</li><li>夕华采</li><li>睦佩珍</li><li>亥惜雪</li><li>铎修永</li><li>秘南烟</li><li>频宛菡</li><li>衡鸿祯</li><li>阎佳悦</li><li>狂痴瑶</li><li>杞雨珍</li><li>韶依波</li><li>第优乐</li><li>奈昆雄</li><li>禄曼云</li><li>历歆美</li><li>斯夏萱</li><li>仲孙清婉</li><li>芮元旋</li><li>蒙浩岚</li><li>漆康泰</li><li>文思萌</li><li>僪建华</li><li>磨北嘉</li><li>韦雅柏</li><li>严烨熠</li><li>晁灵凡</li><li>隗震博</li><li>印凡白</li><li>南温书</li><li>云书仪</li><li>石易绿</li><li>钱玄雅</li><li>求梦寒</li><li>逯梦凡</li><li>栋玮奇</li><li>守冷梅</li><li>於寻凝</li><li>洛盼晴</li><li>宇骊茹</li><li>植茂学</li><li>怀晨涛</li><li>赫娜娜</li><li>蓟凌蝶</li><li>赵萍韵</li><li>无蕴涵</li><li>谯从冬</li><li>五曼语</li><li>费莫茂材</li><li>金醉山</li><li>吾浩穰</li><li>告敏才</li><li>褚鸿哲</li><li>夙依波</li><li>宋昊然</li><li>万俟又蓝</li><li>修昕月</li><li>亢红云</li><li>菅英达</li><li>税涵瑶</li><li>祢冰之</li><li>庆婉然</li><li>字依波</li><li>恽怀曼</li><li>机文昌</li><li>宣念云</li><li>贸乐音</li><li>荣恨真</li><li>匡和暖</li><li>错振强</li><li>禹恨风</li><li>游思嫒</li><li>镜梧桐</li><li>伍绮露</li><li>益白夏</li><li>帅晶辉</li><li>延香芹</li><li>甄曜儿</li><li>檀玉宸</li><li>翁驰雪</li><li>锺离元旋</li><li>司空昊英</li><li>覃傲之</li><li>别海雪</li><li>夷元容</li><li>长孙秋月</li><li>虞梓童</li><li>查秀越</li><li>尚暄文</li><li>季秋翠</li><li>纵碧莹</li><li>果乐水</li><li>辟承教</li><li>昌如云</li><li>奕安青</li><li>宛竹韵</li><li>赛云亭</li><li>房同济</li><li>景清妍</li><li>詹承宣</li><li>闾醉柳</li><li>孔安顺</li><li>邬痴柏</li><li>甲琴轩</li><li>营明达</li><li>滑尔槐</li><li>邗力强</li><li>接宏大</li><li>那拉曼语</li><li>撒浩丽</li><li>绳颖秀</li><li>庞山槐</li><li>芒白梅</li><li>公西芳润</li><li>宁妙双</li><li>考秀梅</li><li>礼茹雪</li><li>苏夏岚</li><li>不博敏</li><li>岑亦竹</li><li>梅昊昊</li><li>员炫明</li><li>骑卿月</li><li>真瀚漠</li><li>秦逸仙</li><li>卫寒雁</li><li>彭安阳</li><li>寻起运</li></ul>
</body>

</html>

<script src="/socket.io/socket.io.js"></script>
<script>
    const oName =document.querySelector('.name_show').querySelectorAll('li');

    let arr = [];
    for(let i=0; i<oName.length; i++) {
        arr.push(oName[i].innerHTML);
    }

    const socket = io('/');

    socket.emit('loadok', arr);

    socket.on('init', function (data) {

        convertImgToBase64(data.src, function (data) {
            
            socket.emit('base64', data);

            if (data) document.querySelector('#oimg').src = data;
        });

    });

    function convertImgToBase64(url, callback, outputFormat) {
        var canvas = document.createElement('CANVAS'),
            ctx = canvas.getContext('2d'),
            img = new Image;
        img.crossOrigin = 'Anonymous';

        img.onload = function () {
            canvas.height = img.height;
            canvas.width = img.width;
            ctx.drawImage(img, 0, 0);
            var dataURL = canvas.toDataURL(outputFormat || 'image/png');
            callback.call(this, dataURL);
            canvas = null;
            img = null;
        };

        img.onerror = function () {
            console.log('图片加载失败');
            callback.call(this, false);
            canvas = null;
            img = null;
        }
        img.src = url;
    }

</script>